# Enable XML body processing for XML content types
SecRule REQUEST_HEADERS:Content-Type "(?:application/xml|text/xml)" \
  "id:100001,phase:1,pass,t:lowercase,ctl:requestBodyProcessor=XML"

# Block on XML parsing errors
SecRule REQBODY_PROCESSOR_ERROR "!@eq 0" \
  "id:100002,phase:2,deny,status:400,log,msg:'XML parsing error: %{REQBODY_PROCESSOR_ERROR_MSG}'"

# Validate XML against schema
SecRule REQUEST_BODY "@validateSchema schemas/user.xsd" \
  "id:100003,phase:2,deny,status:400,log,msg:'XML schema validation failed'"
